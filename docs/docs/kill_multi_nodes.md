# 脚本功能概述

这是一个功能强大且安全的分布式多节点进程清理脚本。它的主要目的是帮助你**批量、安全地终止**远程服务器上与分布式训练、开发环境或特定项目相关的后台进程。

该脚本具备以下核心优势：

- **智能筛选**：通过可配置的关键词（如 `llmtuner`、`python` 等），精确地定位并清理目标进程。
- **安全排除**：默认配置会**自动排除** VS Code 等开发环境相关的进程，避免误杀。
- **优雅退出**：采用“先礼后兵”的策略，首先尝试发送 `SIGTERM` 信号让进程温和退出，超时后才会强制终止（`SIGKILL`），最大限度地减少数据丢失或损坏的风险。
- **高效率**：利用并发处理技术，可以同时连接多个节点并执行清理任务，大大缩短操作时间。
- **用户友好**：在执行高风险的清理操作前，会要求用户进行二次确认，防止误操作。

# 使用说明

 1. 配置节点列表文件

在脚本的同级目录下，确保你的节点列表文件路径正确无误。默认路径为 `/home/jianzhnie/llmtuner/tools/nodes/node_list_all.txt`。在该文件中，每行写入一个节点的 IP 地址或主机名。

**示例：**

```
192.168.1.101
192.168.1.102
node-03
```

 2. 配置要清理的关键词

在脚本的 `KEYWORDS` 变量中，你可以自定义要匹配的进程关键词。你可以添加任何与你的项目相关的关键词，脚本将根据这些词来查找并清理进程。

**示例：**

```
KEYWORDS=("my-project-keyword" "another-script-name")
```

 3. 运行脚本

在主节点上执行脚本，并根据提示输入 `yes` 进行确认。

```
bash kill_multi_nodes.sh
```

**⚠️ 注意**：由于脚本会要求用户确认，因此它不适合在无人值守的自动化任务中直接运行。如果你需要在自动化流程中使用，请移除用户确认步骤。

 4. 查看日志

脚本运行过程中，会输出带时间戳的详细日志，让你清楚地知道每个节点的处理状态。
